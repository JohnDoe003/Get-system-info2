#Function to create a new Jira issue
void create_newjira_issue() {
  node {
    stage('JIRA') {
      def NewJiraIssue = [fields: [project: [key: 'JT'],
        summary: 'Build Failed : Summary.',
        description: 'Description of JIRA ticket ',
        issuetype: [name: 'Bug']]]

      response = jiraNewIssue issue: NewJiraIssue, site: 'THAT CAN BE SET IN JENKINS CONFIGURATION OR CAN DIRECTLY WRITE HERE'

      echo response.successful.toString()
      echo response.data.toString()
    }
  }
}

pipeline {
  agent any

  stages {
    stage('version') {
      steps {
        sh 'python3 --version'
      }
    }

    stage('getinfo') {
      steps {
        // Run the Python script using the Anaconda Python interpreter
        sh '/Users/manasvidhankani/opt/anaconda3/bin/python test.py'
      }
    }
  }

  post {
    failure {
      // Create Jira issue if build fails
      create_newjira_issue()
    }
  }
}
