import org.jenkinsci.plugins.jira.steps.NewIssueStep
// Function to create a new Jira issue
void create_newjira_issue() {
    node {
        stage('JIRA') {
            def jiraURL = 'https://manasvid.atlassian.net'
            def jiraUsername = 'manasvid'
            def jiraPasswordOrToken = 'ATATT3xFfGF0A4xLOweqmbnlw3X6mpVbsRF1GtenOIS64NLab4DVIT4lBHlR2F8t_0xfA1M63LR7TS1Fi3_M_IPoyAXNV-Vxdj1twD-2GmsSeIhhH3IqkmpL9yoDOAD8YqQShSpSF9OW4r8ttlUSWG717KRPGIXMWNE5SHbjBZ5aP2CRsSlt0EQ=ED677264'

                def NewJiraIssue = [
                    fields: [
                        project: [key: 'JT'],
                        summary: 'Build Failed: Summary.',
                        description: 'Description of JIRA ticket from Jenkins',
                        issuetype: [name: 'Bug']
                    ]
                ]

                // Create the Jira issue
                response = newIssueStep issue: NewJiraIssue, site: jiraURL, credentialsId: 'f4f6fc3b-b281-45b3-8085-b77c53e0fd69'

                echo response.successful.toString()
                echo response.data.toString()
            }
        }
    }
}

pipeline {
    agent any

    stages {
        stage('version') {
            steps {
                sh 'python3 --version'
            }
        }

        stage('getinfo') {
            steps {
                // Run the Python script using the Anaconda Python interpreter
                sh '/Users/manasvidhankani/opt/anaconda3/bin/python test.py'
            }
        }
    }

    post {
        failure {
            // Create Jira issue if build fails
            create_newjira_issue()
        }
    }
}







































